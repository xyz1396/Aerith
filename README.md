
### Aerith

![Aerith](./png/logo.png)

Aerith, as the last surviving Cetra, or "Ancient", can talk to the planet in Final Fantasy VII. In SIP (stable isotpe probe) or other stable isotope analysis, we are talking earth or even the universe by element's isotope. This R package, Aerith provides interfaces to read and write Mass spectrum scan, calculate theorotic isotopic peak envolop of peptide precursor and its B Y ions, score and visualize the PSM (peptide and spectra match), and visualize the TIC (total ion current) by Rcpp.

### Install 

You can download the source package in release to install or install from github directlly by following code in R. 

```r
library(devtools)
install_github("xyz1396/Aerith")
```

### Read and write Mass spectrum scan

Now we only support read .FT1 or .FT2 files well generated by [Raxport.net](https://github.com/xyz1396/Raxport.net)

Read .FT1 file 

```r
ft1 <- readAllScanMS1("demo.FT1")
```

Read .FT2 file 

```r
ft2 <- readAllScanMS2("demo.FT2")
```

Read .mzML file. You need to install mzR first

```r
ft1 <- readMzmlMS1("demo.mzML")
ft2 <- readMzmlMS2("demo.mzML")
```

Write .FT2 file

```r
header <- readFTheader("demo.ft2")
ft2 <- readAllScanMS2("demo.ft2")
writeAllScanMS2(header,ft2[1:10],"demo10.ft2")
```

### Calculate theorotic peak

#### Precursor

```r
a <- getSipPrecursorSpectra("KHRIPCDRK", "C13", 0.25, 2)
plot(a)
```
![Peak](./png/theoreticPeaks.png)

#### B Y ions

```r
a <- getSipBYionSpectra("KHRIPCDRK", "C13", 0.25, 1:2, 2)
plot(a)
```

![BY](./png/BYions.png)

### PSM visualization

```r
a <- getSipBYionSpectra("KHRIPCDRK", "C13", 0.25, 1:2)
p <- plot(a)
p <- p + plotSipBYionLabel(a)
b <- readAllScanMS2("demo.FT2")
c <- getRealScan(18, b)
p <- p + plotRealScan(c)
p
```

![PSM](./png/PSM.png)


### TIC visualization

```r
a <- readAllScanMS2("demo.FT2")
b <- getTIC(a)
plotTIC(b)
```

![TIC](./png/TIC.png)